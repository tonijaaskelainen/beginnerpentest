# Penetration Testing -harjoitusympäristön toteutus vapailla ohjelmilla
## Kali Linuxiin sisältyvällä Metasploitilla tunkeutuminen Metasploitable 2 -koneeseen Vagrant-virtuaaliympäristössä

Toni Jääskeläinen

Opinnäytetyö  
Tietojenkäsittelyn koulutusohjelma  
13.9.2016

# Johdanto

Täydennetään myöhemmin lisää...

## Projektin tausta

Projekti käynnistetään opiskelijan opinnäytetyönä, koska opiskelijan mielestä aihealue on kiinnostava ja olisi hyvä saada aikaan ympäristö, jossa tunkeutumistestausta voi harjoitella turvallisesti. Projektiin liittyviä lähteitä on jo luettu hieman. Projektista saatava hyöty on käytännön ympäristö, jossa voi turvallisesti harjoitella tunkeutumistestausta.

## Projektin tavoite, tehtävä ja tulokset

Työn tehtävänä on selvittää, kuinka Penetration Testing -harjoitusympäristö toteutetaan vapailla ohjelmilla. Tavoitteena on saada aikaan ympäristö, jossa voi turvallisesti harjoitella tunkeutumistestausta. Ympäristö pitää myös olla helposti saatavilla ja hyödynnettävissä. Projektin tuloksena syntyy tunkeutumistestaukseen sopiva virtualisoitu harjoitusympäristö, jonka voi ladata GitHubista. Projektissa opitaan käyttämään GitHubia, pystyttämään tarvittava ympäristö ja tunkeutumaan johonkin kohteeseen jollakin vapaalla työkalulla, kun ympäristöä testataan. Tätä varten projektissa verrataan työhön sopivia työkaluja keskenään.

## Tutkimuskysymykset

Seuraaviin kysymyksiin vastaaminen auttaa projektin tavoitteiden ja tehtävän saavuttamisessa. Kysymykset on jaoteltu pääkysymykseen ja alakysymyksiin.

Tutkimuksen pääkysymys:

- Kuinka vapailla ohjelmilla toteutetaan Penetration Testing -harjoitusympäristö?

Tutkimuksen alakysymykset:

- Millä välineillä Penetration Testing -harjoitusympäristö kannattaa toteuttaa?

- Millä välineillä tunkeutuminen Penetration Testing -harjoitusympäristöön kannattaa toteuttaa?

- Minkälaiseen kohteeseen kannattaa tunkeutua Penetration Testing -harjoitusympäristössä?

## Kohderyhmä ja rajaus

Työn kohderyhmänä ovat Penetration Testing -aloittelijat, jotka hallitsevat Linuxin ja komentorivin käytön. Työ rajataan käsittämään vapaat ohjelmat. Työhön valitaan yksi tunkeutumistyökalu, yksi virtuaaliympäristön mahdollistava kokonaisuus ja yksi kohde, johon tunkeudutaan.

## Menetelmät ja työn rakenne

Työ tehdään GitHubiin. Työssä pystytetään ympäristö ja testataan sen toiminta. Ensin työssä käydään läpi, mitä Penetration Testing on. Tämän jälkeen verrataan ympäristön toteutukseen soveltuvia työkaluja keskenään. Seuraavaksi verrataan, minkälaisilla työkaluilla tunkeutuminen kannattaa toteuttaa. Sitten verrataan, minkälaiseen kohteeseen kannattaa tunkeutua Penetration Testing -harjoitusympäristössä. Kun nämä asiat ovat selvillä, niin ympäristö toteutetaan valitulla välineellä ja testataan valittuun kohteeseen tunkeutumista sitä varten valitulla työkalulla. Lopuksi pohditaan, miten työn tulokset vastaavat työn tavoitteeseen.

## Käsitteet

|Käsite			| Määritelmä													|
|-----------------------|---------------------------------------------------------------------------------------------------------------|
|Penetration Testing | Tunkeutumistestaus. Sallittu murtautuminen tietojärjestelmiin tietoturvan tilan kartoittamiseksi.		|
|IDS | Intrusion Detection System. Tunkeutumisen havaitsemisjärjestelmä. Järjestelmä, joka yrittää havaita mahdollisen tunkeutujan.	|
|IPS | Intrusion Prevention System. Tunkeutumisenestojärjestelmä. Järjestelmä, joka yrittää estää mahdollisen tunkeutumisen.		|
|Pääsynhallinta | Tapa hallita pääsyä järjestelmään esimerkiksi käyttäjätunnuksilla ja salasanoilla.					|
|Palomuuri | Laite tai ohjelmisto, joka suojaa verkkoa suodattamalla tietoliikennettä tiettyjen sääntöjen mukaan.                       |

# Penetration Testing eli tunkeutumistestaus

Tunkeutumistestauksella (eng. Penetration Testing) tarkoitetaan sallittua murtautumista tietojärjestelmiin ja IT-infrastruktuuriin, jotta saataisiin arvioitua tiettyjen puolustusmekanismien tehokkuus ja kartoitettua, onko ohjelmissa haavoittuvuuksia tai konfigurointivirheitä. Testauksen avulla on myös mahdollista selvittää, noudattavatko käyttäjät tietoturvapolitiikkaa vai käyttäytyvätkö he riskialttiisti yrityksen kannalta. Tunkeutumistestaus suoritetaan yleensä manuaalisesti tai automaattisesti potentiaalisesti alttiisiin kohteisiin, kuten palvelimiin, päätelaitteisiin, langattomiin verkkoihin sekä tietoliikenne- ja mobiililaitteisiin. Jos tunkeutuminen onnistuu jonkin haavoittuvuuden kautta, niin testaajat saattavat yrittää peräkkäisiä hyökkäyksiä ja käyttöoikeuksien korottamista päästäkseen syvemmälle järjestelmiin ja saadakseen tarkemman kuvan järjestelmien tilasta. Kaikki löydetyt haavoittuvuudet, joihin hyökkäys onnistui, esitellään yleensä IT- ja verkkojärjestelmien hallinnoijille strategisten päätösten tekoa ja parannuskeinojen priorisointia varten. Tunkeutumistestauksen perustarkoitus on mitata, kuinka käyttökelpoisia väärin konfiguroidut tai käyttäjien vaarantamat järjestelmät ovat hyökkääjille. Lisäksi testauksessa arvioidaan vastaavien tilanteiden aiheuttamat seuraukset resursseille tai toiminnoille. (Core Security 2015.)

Tunkeutumistestaus on tärkeää, koska tietomurrot ja palvelukatkokset ovat kalliita. Ne voivat taloudellisten kulujen lisäksi heikentää yrityksen mainetta ja vähentää asiakaskuntaa. Lisäksi on mahdotonta turvata kaikki mahdollinen tieto koko ajan. Perinteiset usean kerroksen puolustusmekanismit, kuten pääsynhallinta, salakirjoitus, IPS, IDS ja palomuurit sekä uusien teknologioiden käyttöönotto ovat lisänneet monimutkaisuutta ja täten tehneet jopa entistä vaikeammaksi tunnistaa kaikki yrityksen mahdolliset haavoittuvuudet. Tunkeutumistestaus auttaa identifioimaan ja priorisoimaan erilaisia turvallisuusriskejä arvioimalla yrityksen kykyä suojata hyödykkeitä sisäiseltä ja ulkoiselta väärinkäytöltä. Jotta voitaisiin varmistaa yhdenmukainen IT- ja verkkoturvallisuuden hallinta, pitäisi tunkeutumistestaus suorittaa säännöllisin väliajoin perusteellisesti. Näin voidaan tehokkaammin estää luvaton pääsy kriittisiin järjestelmiin ja niissä oleviin tietoihin. (Core Security 2015.)

Core Securityn (2015) mukaan tunkeutumistestaus pitäisi lisäksi suorittaa aina, kun

- verkkoinfrastruktuuria tai sovelluksia lisätään
- infrastruktuuriin tai sovelluksiin kohdistuu merkittäviä parannuksia/päivityksiä tai muutoksia
- uusia toimistotiloja otetaan käyttöön
- turvallisuuspaikkauksia otetaan käyttöön
- loppukäyttäjäpolitiikkaa muutetaan.

Tunkeutumistestauksen moniin hyötyihin kuuluu älykäs haavoittuvuuksien hallinta, verkon alhaallaolokulujen välttäminen, säännösteltyjen vaatimusten täyttäminen ja sakkojen välttäminen sekä yrityskuvan ja asiakaskunnan säilyttäminen. Älykäs haavoittuvuuksien hallinta tarkoittaa, että tunkeutumistestauksen avulla saadaan tarkkaa tietoa varsinaisista, hyökättävissä olevista haavoittuvuuksista ja näin pystytään identifioimaan kriittisimpien haavoittuvuuksien joukosta vähemmän merkittävät ja väärät hälytykset. Tämä mahdollistaa parannuskeinojen priorisoinnin ja turvallisuusresurssien tehokkaamman allokoinnin oikeaan aikaan oikeisiin paikkoihin. Verkon alhaallaolokulujen välttäminen tarkoittaa, että tunkeutumistestauksella pystytään ennakoivasti tunnistamaan ja osoittamaan riskejä ennen kuin hyökkäyksiä tai murtoja tapahtuu, ja näin vältetään taloudelliset riskit. Säännösteltyjen vaatimusten täyttäminen ja sakkojen välttäminen tarkoittaa, että tunkeutumistestaus auttaa yrityksiä osoittamaan, että ne noudattavat tiettyjä määräyksiä. Tunkeutumistestauksessa syntyvät tarkat raportit auttavat yrityksiä välttämään määräysten noudattamattomuudesta aiheutuvia sakkoja. Yrityskuvan ja asiakaskunnan säilyttäminen tarkoittaa, että tunkeutumistestaus auttaa yritystä säilyttämään sen maineen ja luotettavuuden, koska yksikin tietomurto voi karkottaa yrityksen nykyisiä asiakkaita ja estää uusien asiakassuhteiden syntymistä. (Core Security 2015.)

## Tunkeutumistestauksen standardi

Tunkeutumistestausta varten on olemassa lähes muodollinen standardi, jonka tarkoitus on tarjota yrityksille ja tunkeutumistestauksen tarjoajille yhteinen kieli. Nämä ovat täten kyseisen standardin kohderyhmänä. Standardin on tarkoitus sisältää minimilähtökohdat tunkeutumistestauksen suorittamista varten. Tämä tarkoittaa, että yritysten on tarkoitus pystyä vaatimaan tunkeutumistestaustyöltä tietyt lähtökohdat standardin avulla. Vastaavasti standardin on tarkoitus tarjota tunkeutumistestauksen tekijöille lähtökohdat huomioon otettavista asioista kartoituksesta raportointiin asti. Lisäksi standardin on myös tarkoitus sisältää korkeampia tasoja vaativampia turvallisuustarpeita varten. Nämä tasot on tarkoitus määritellä alakohtaisesti. Standardi tulee määrittelemään teknisen raportoinnin lisäksi myös mallin yritysjohdolle raportointia varten. (The Penetration Testing Execution Standard 2015.)

Tunkeutumistestauksen standardi määrittelee, mitä osa-alueita tunkeutumistestaukseen kuuluu. The Penetration Testing Execution Standardin (2014) mukaan nämä ovat

- Pre-engagement Interactions (työtä edeltävä vuorovaikutus kohteen kanssa)
- Intelligence Gathering (tiedon kerääminen)
- Threat Modeling (uhkien mallintaminen)
- Vulnerability Analysis (haavoittuvuuksien analysointi)
- Exploitation (haavoittuvuuksiin hyökkääminen)
- Post Exploitation (hyökkäysten jälkeiset toimenpiteet)
- Reporting (raportointi).

Seuraavaksi käydään näitä osa-alueita läpi yksi kerrallaan.

# Välineet ympäristön toteutukseen



## Vagrant



## VirtualBox



# Välineet ympäristöön tunkeutumiseen



## Metasploit Framework



## Burp Suite



# Kohde, johon tunkeudutaan



## Metasploitable 2



## Muut peruspalvelimet



# Penetration Testing -harjoitusympäristön toteutus



## Virtuaaliympäristön pystytys



## Tunkeutumisen testaaminen



# Pohdinta



# Lähteet

Core Security 2015. Penetration Testing Overview. Luettavissa: http://www.coresecurity.com/penetration-testing-overview. Luettu: 5.12.2015.
(Tarkistettu 13.9.2016, että tieto löytyy Internet Archive Wayback Machinesta http://web.archive.org/web/20160104132108/http://www.coresecurity.com/penetration-testing-overview.

The Penetration Testing Execution Standard 16.8.2014. High Level Organization of the Standard. Luettavissa: http://www.pentest-standard.org/index.php/Main_Page. Luettu: 5.12.2015.

The Penetration Testing Execution Standard 28.10.2015. Penetration Testing Execution Standard - the FAQ. Luettavissa: http://www.pentest-standard.org/index.php/FAQ. Luettu 13.9.2016.

# Liitteet




